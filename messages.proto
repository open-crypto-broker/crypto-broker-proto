syntax = "proto3";

package CryptoBroker;

option go_package = "internal/protobuf";

service CryptoGrpc {
  rpc Benchmark(BenchmarkRequest) returns (BenchmarkResponse);
  rpc Hash(HashRequest) returns (HashResponse);
  rpc Sign(SignRequest) returns (SignResponse);
}

// Metadata shared across all methods
message Metadata {
  string id=1;
  string createdAt=2;
}

// Message for a Benchmark Request
message BenchmarkRequest {
  Metadata metadata=1;
}

// Response for a Benchmark Request
message BenchmarkResponse {
  string benchmarkResults=1;
  Metadata metadata=2;
}

// Message for a Hash Request
message HashRequest {
  string profile=1;
  bytes input=2;
  Metadata metadata=3;
}

// Response to a Hash Request
message HashResponse {
  string hashValue=1;
  string hashAlgorithm=2;
  Metadata metadata=3;
}

// Message for a CSR (Certificate Signing Request)
message SignRequest {
  string profile=1;
  string csr=2;
  string caPrivateKey=3;
  string caCert=4;
  Metadata metadata=5;
  optional uint64 validNotBefore=6;
  optional uint64 validNotAfter=7;
  optional string subject=8;
  repeated string crlDistributionPoints=9;
}

// Response to a Sign Request
message SignResponse {
  string signedCertificate=1;
  Metadata metadata=2;
}
