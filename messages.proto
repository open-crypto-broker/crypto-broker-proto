syntax = "proto3";

package protobuf;

option go_package = "internal/protobuf";

service CryptoBroker {
  rpc Hash(HashRequest) returns (HashResponse);
  rpc Sign(SignRequest) returns (SignResponse);
}

// Metadata shared across al methods
message Metadata {
  string id =1;
	string createdAt=2;
}

// Message for a Hash Request
message HashRequest {
  string profile = 1;
  bytes input = 2;
  Metadata metadata=3;
}

// Response to a Hash Request
message HashResponse {
  string hashValue = 1;
  string hashAlgorithm = 2;
  Metadata metadata=3;
}

// Message for a CSR (Certificate Sign Request)
message SignRequest {
  string profile = 1;
  string csr=2;
  string caPrivateKey=3;
  string caCert=4;
  Metadata metadata=5;
  optional string validNotBeforeOffset=6;
  optional string validNotAfterOffset=7;
  optional string subject=8;
  repeated string crlDistributionPoints=9;
}

// Response to a Sign Request
message SignResponse {
  string signedCertificate = 1;
  Metadata metadata=2;
}
